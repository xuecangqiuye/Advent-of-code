import cn.hutool.core.collection.CollUtil;

import java.util.*;
import java.util.stream.Collectors;

/**
 * @Author: wangshengbin
 * @Date: 2024/12/14 13:47
 * @Description:
 */
public class Day5 {

    public static void main(String[] args) {
        String input = "59|55\n" +
                "48|63\n" +
                "48|74\n" +
                "26|77\n" +
                "26|54\n" +
                "26|99\n" +
                "63|43\n" +
                "63|65\n" +
                "63|11\n" +
                "63|42\n" +
                "91|64\n" +
                "91|77\n" +
                "91|71\n" +
                "91|42\n" +
                "91|33\n" +
                "46|63\n" +
                "46|48\n" +
                "46|72\n" +
                "46|21\n" +
                "46|12\n" +
                "46|82\n" +
                "21|32\n" +
                "21|11\n" +
                "21|52\n" +
                "21|64\n" +
                "21|59\n" +
                "21|34\n" +
                "21|33\n" +
                "99|82\n" +
                "99|37\n" +
                "99|21\n" +
                "99|27\n" +
                "99|92\n" +
                "99|79\n" +
                "99|56\n" +
                "99|12\n" +
                "38|51\n" +
                "38|47\n" +
                "38|77\n" +
                "38|88\n" +
                "38|34\n" +
                "38|52\n" +
                "38|32\n" +
                "38|11\n" +
                "38|64\n" +
                "33|42\n" +
                "33|54\n" +
                "33|56\n" +
                "33|47\n" +
                "33|93\n" +
                "33|31\n" +
                "33|52\n" +
                "33|99\n" +
                "33|34\n" +
                "33|77\n" +
                "32|52\n" +
                "32|88\n" +
                "32|56\n" +
                "32|45\n" +
                "32|77\n" +
                "32|18\n" +
                "32|42\n" +
                "32|46\n" +
                "32|71\n" +
                "32|47\n" +
                "32|33\n" +
                "96|45\n" +
                "96|31\n" +
                "96|11\n" +
                "96|74\n" +
                "96|59\n" +
                "96|55\n" +
                "96|42\n" +
                "96|71\n" +
                "96|39\n" +
                "96|43\n" +
                "96|44\n" +
                "96|32\n" +
                "77|71\n" +
                "77|54\n" +
                "77|93\n" +
                "77|81\n" +
                "77|72\n" +
                "77|15\n" +
                "77|64\n" +
                "77|88\n" +
                "77|76\n" +
                "77|56\n" +
                "77|31\n" +
                "77|92\n" +
                "77|84\n" +
                "27|44\n" +
                "27|96\n" +
                "27|18\n" +
                "27|91\n" +
                "27|37\n" +
                "27|59\n" +
                "27|77\n" +
                "27|12\n" +
                "27|55\n" +
                "27|39\n" +
                "27|26\n" +
                "27|57\n" +
                "27|21\n" +
                "27|32\n" +
                "76|92\n" +
                "76|57\n" +
                "76|12\n" +
                "76|15\n" +
                "76|44\n" +
                "76|82\n" +
                "76|11\n" +
                "76|61\n" +
                "76|38\n" +
                "76|74\n" +
                "76|96\n" +
                "76|65\n" +
                "76|51\n" +
                "76|37\n" +
                "76|91\n" +
                "79|16\n" +
                "79|92\n" +
                "79|58\n" +
                "79|48\n" +
                "79|12\n" +
                "79|96\n" +
                "79|63\n" +
                "79|76\n" +
                "79|38\n" +
                "79|57\n" +
                "79|61\n" +
                "79|37\n" +
                "79|27\n" +
                "79|51\n" +
                "79|65\n" +
                "79|91\n" +
                "93|58\n" +
                "93|54\n" +
                "93|12\n" +
                "93|48\n" +
                "93|16\n" +
                "93|38\n" +
                "93|92\n" +
                "93|56\n" +
                "93|57\n" +
                "93|15\n" +
                "93|74\n" +
                "93|37\n" +
                "93|61\n" +
                "93|91\n" +
                "93|65\n" +
                "93|76\n" +
                "93|51\n" +
                "84|27\n" +
                "84|38\n" +
                "84|59\n" +
                "84|63\n" +
                "84|91\n" +
                "84|12\n" +
                "84|44\n" +
                "84|37\n" +
                "84|57\n" +
                "84|82\n" +
                "84|11\n" +
                "84|61\n" +
                "84|15\n" +
                "84|92\n" +
                "84|58\n" +
                "84|51\n" +
                "84|39\n" +
                "84|65\n" +
                "45|56\n" +
                "45|57\n" +
                "45|65\n" +
                "45|27\n" +
                "45|48\n" +
                "45|61\n" +
                "45|63\n" +
                "45|81\n" +
                "45|99\n" +
                "45|79\n" +
                "45|72\n" +
                "45|54\n" +
                "45|84\n" +
                "45|92\n" +
                "45|12\n" +
                "45|76\n" +
                "45|93\n" +
                "45|88\n" +
                "45|16\n" +
                "16|27\n" +
                "16|59\n" +
                "16|34\n" +
                "16|18\n" +
                "16|26\n" +
                "16|51\n" +
                "16|58\n" +
                "16|38\n" +
                "16|33\n" +
                "16|11\n" +
                "16|21\n" +
                "16|61\n" +
                "16|96\n" +
                "16|39\n" +
                "16|57\n" +
                "16|43\n" +
                "16|12\n" +
                "16|44\n" +
                "16|37\n" +
                "16|55\n" +
                "57|39\n" +
                "57|34\n" +
                "57|58\n" +
                "57|74\n" +
                "57|51\n" +
                "57|71\n" +
                "57|33\n" +
                "57|77\n" +
                "57|55\n" +
                "57|96\n" +
                "57|91\n" +
                "57|47\n" +
                "57|18\n" +
                "57|43\n" +
                "57|44\n" +
                "57|37\n" +
                "57|42\n" +
                "57|21\n" +
                "57|11\n" +
                "57|64\n" +
                "57|32\n" +
                "15|33\n" +
                "15|32\n" +
                "15|63\n" +
                "15|16\n" +
                "15|65\n" +
                "15|27\n" +
                "15|44\n" +
                "15|38\n" +
                "15|58\n" +
                "15|59\n" +
                "15|11\n" +
                "15|21\n" +
                "15|37\n" +
                "15|92\n" +
                "15|96\n" +
                "15|91\n" +
                "15|18\n" +
                "15|57\n" +
                "15|39\n" +
                "15|61\n" +
                "15|12\n" +
                "15|43\n" +
                "55|34\n" +
                "55|52\n" +
                "55|84\n" +
                "55|31\n" +
                "55|15\n" +
                "55|48\n" +
                "55|79\n" +
                "55|71\n" +
                "55|77\n" +
                "55|46\n" +
                "55|45\n" +
                "55|99\n" +
                "55|88\n" +
                "55|76\n" +
                "55|47\n" +
                "55|81\n" +
                "55|93\n" +
                "55|64\n" +
                "55|82\n" +
                "55|56\n" +
                "55|54\n" +
                "55|72\n" +
                "55|26\n" +
                "88|76\n" +
                "88|81\n" +
                "88|65\n" +
                "88|16\n" +
                "88|54\n" +
                "88|82\n" +
                "88|57\n" +
                "88|63\n" +
                "88|31\n" +
                "88|12\n" +
                "88|46\n" +
                "88|72\n" +
                "88|99\n" +
                "88|92\n" +
                "88|27\n" +
                "88|61\n" +
                "88|93\n" +
                "88|52\n" +
                "88|84\n" +
                "88|56\n" +
                "88|15\n" +
                "88|48\n" +
                "88|79\n" +
                "88|58\n" +
                "72|91\n" +
                "72|38\n" +
                "72|61\n" +
                "72|92\n" +
                "72|93\n" +
                "72|56\n" +
                "72|82\n" +
                "72|16\n" +
                "72|12\n" +
                "72|65\n" +
                "72|76\n" +
                "72|57\n" +
                "72|37\n" +
                "72|54\n" +
                "72|51\n" +
                "72|58\n" +
                "72|15\n" +
                "72|63\n" +
                "72|84\n" +
                "72|96\n" +
                "72|48\n" +
                "72|21\n" +
                "72|74\n" +
                "72|27\n" +
                "31|54\n" +
                "31|65\n" +
                "31|16\n" +
                "31|91\n" +
                "31|61\n" +
                "31|46\n" +
                "31|58\n" +
                "31|57\n" +
                "31|92\n" +
                "31|99\n" +
                "31|15\n" +
                "31|63\n" +
                "31|56\n" +
                "31|81\n" +
                "31|76\n" +
                "31|93\n" +
                "31|79\n" +
                "31|84\n" +
                "31|48\n" +
                "31|12\n" +
                "31|72\n" +
                "31|82\n" +
                "31|27\n" +
                "31|52\n" +
                "51|55\n" +
                "51|33\n" +
                "51|59\n" +
                "51|44\n" +
                "51|47\n" +
                "51|32\n" +
                "51|99\n" +
                "51|39\n" +
                "51|64\n" +
                "51|52\n" +
                "51|26\n" +
                "51|71\n" +
                "51|45\n" +
                "51|77\n" +
                "51|43\n" +
                "51|81\n" +
                "51|18\n" +
                "51|11\n" +
                "51|31\n" +
                "51|42\n" +
                "51|88\n" +
                "51|74\n" +
                "51|46\n" +
                "51|34\n" +
                "34|84\n" +
                "34|52\n" +
                "34|77\n" +
                "34|71\n" +
                "34|92\n" +
                "34|56\n" +
                "34|45\n" +
                "34|26\n" +
                "34|93\n" +
                "34|54\n" +
                "34|15\n" +
                "34|31\n" +
                "34|64\n" +
                "34|48\n" +
                "34|82\n" +
                "34|76\n" +
                "34|47\n" +
                "34|79\n" +
                "34|99\n" +
                "34|81\n" +
                "34|88\n" +
                "34|63\n" +
                "34|46\n" +
                "34|72\n" +
                "47|46\n" +
                "47|63\n" +
                "47|72\n" +
                "47|45\n" +
                "47|52\n" +
                "47|31\n" +
                "47|93\n" +
                "47|71\n" +
                "47|56\n" +
                "47|15\n" +
                "47|48\n" +
                "47|84\n" +
                "47|65\n" +
                "47|79\n" +
                "47|76\n" +
                "47|27\n" +
                "47|16\n" +
                "47|81\n" +
                "47|82\n" +
                "47|92\n" +
                "47|88\n" +
                "47|54\n" +
                "47|61\n" +
                "47|99\n" +
                "71|16\n" +
                "71|79\n" +
                "71|15\n" +
                "71|81\n" +
                "71|63\n" +
                "71|27\n" +
                "71|52\n" +
                "71|82\n" +
                "71|65\n" +
                "71|12\n" +
                "71|88\n" +
                "71|54\n" +
                "71|45\n" +
                "71|99\n" +
                "71|93\n" +
                "71|56\n" +
                "71|92\n" +
                "71|48\n" +
                "71|31\n" +
                "71|61\n" +
                "71|76\n" +
                "71|84\n" +
                "71|72\n" +
                "71|46\n" +
                "58|51\n" +
                "58|37\n" +
                "58|39\n" +
                "58|21\n" +
                "58|33\n" +
                "58|38\n" +
                "58|55\n" +
                "58|74\n" +
                "58|59\n" +
                "58|44\n" +
                "58|71\n" +
                "58|43\n" +
                "58|32\n" +
                "58|77\n" +
                "58|96\n" +
                "58|47\n" +
                "58|91\n" +
                "58|64\n" +
                "58|42\n" +
                "58|11\n" +
                "58|18\n" +
                "58|26\n" +
                "58|34\n" +
                "58|45\n" +
                "82|12\n" +
                "82|27\n" +
                "82|32\n" +
                "82|39\n" +
                "82|43\n" +
                "82|92\n" +
                "82|58\n" +
                "82|11\n" +
                "82|44\n" +
                "82|57\n" +
                "82|15\n" +
                "82|74\n" +
                "82|37\n" +
                "82|63\n" +
                "82|51\n" +
                "82|91\n" +
                "82|65\n" +
                "82|59\n" +
                "82|96\n" +
                "82|33\n" +
                "82|38\n" +
                "82|61\n" +
                "82|21\n" +
                "82|16\n" +
                "44|39\n" +
                "44|47\n" +
                "44|99\n" +
                "44|55\n" +
                "44|79\n" +
                "44|32\n" +
                "44|33\n" +
                "44|64\n" +
                "44|31\n" +
                "44|46\n" +
                "44|52\n" +
                "44|42\n" +
                "44|26\n" +
                "44|77\n" +
                "44|45\n" +
                "44|43\n" +
                "44|93\n" +
                "44|72\n" +
                "44|34\n" +
                "44|11\n" +
                "44|71\n" +
                "44|81\n" +
                "44|18\n" +
                "44|88\n" +
                "74|33\n" +
                "74|32\n" +
                "74|44\n" +
                "74|81\n" +
                "74|34\n" +
                "74|79\n" +
                "74|42\n" +
                "74|45\n" +
                "74|26\n" +
                "74|18\n" +
                "74|71\n" +
                "74|99\n" +
                "74|31\n" +
                "74|64\n" +
                "74|88\n" +
                "74|77\n" +
                "74|11\n" +
                "74|55\n" +
                "74|52\n" +
                "74|47\n" +
                "74|59\n" +
                "74|43\n" +
                "74|46\n" +
                "74|39\n" +
                "18|71\n" +
                "18|79\n" +
                "18|84\n" +
                "18|31\n" +
                "18|55\n" +
                "18|48\n" +
                "18|99\n" +
                "18|42\n" +
                "18|77\n" +
                "18|76\n" +
                "18|26\n" +
                "18|47\n" +
                "18|34\n" +
                "18|82\n" +
                "18|88\n" +
                "18|56\n" +
                "18|52\n" +
                "18|45\n" +
                "18|46\n" +
                "18|93\n" +
                "18|72\n" +
                "18|64\n" +
                "18|81\n" +
                "18|54\n" +
                "39|46\n" +
                "39|72\n" +
                "39|71\n" +
                "39|34\n" +
                "39|31\n" +
                "39|88\n" +
                "39|32\n" +
                "39|33\n" +
                "39|26\n" +
                "39|45\n" +
                "39|42\n" +
                "39|55\n" +
                "39|77\n" +
                "39|54\n" +
                "39|99\n" +
                "39|64\n" +
                "39|43\n" +
                "39|52\n" +
                "39|47\n" +
                "39|93\n" +
                "39|79\n" +
                "39|56\n" +
                "39|18\n" +
                "39|81\n" +
                "61|55\n" +
                "61|18\n" +
                "61|32\n" +
                "61|91\n" +
                "61|34\n" +
                "61|57\n" +
                "61|77\n" +
                "61|58\n" +
                "61|39\n" +
                "61|43\n" +
                "61|64\n" +
                "61|37\n" +
                "61|26\n" +
                "61|33\n" +
                "61|74\n" +
                "61|21\n" +
                "61|38\n" +
                "61|51\n" +
                "61|96\n" +
                "61|42\n" +
                "61|12\n" +
                "61|11\n" +
                "61|59\n" +
                "61|44\n" +
                "92|38\n" +
                "92|51\n" +
                "92|18\n" +
                "92|27\n" +
                "92|65\n" +
                "92|96\n" +
                "92|39\n" +
                "92|33\n" +
                "92|61\n" +
                "92|58\n" +
                "92|91\n" +
                "92|57\n" +
                "92|59\n" +
                "92|43\n" +
                "92|74\n" +
                "92|32\n" +
                "92|16\n" +
                "92|12\n" +
                "92|11\n" +
                "92|55\n" +
                "92|44\n" +
                "92|21\n" +
                "92|42\n" +
                "92|37\n" +
                "12|43\n" +
                "12|74\n" +
                "12|37\n" +
                "12|21\n" +
                "12|51\n" +
                "12|58\n" +
                "12|44\n" +
                "12|77\n" +
                "12|64\n" +
                "12|34\n" +
                "12|38\n" +
                "12|32\n" +
                "12|33\n" +
                "12|26\n" +
                "12|59\n" +
                "12|42\n" +
                "12|18\n" +
                "12|11\n" +
                "12|47\n" +
                "12|96\n" +
                "12|91\n" +
                "12|55\n" +
                "12|57\n" +
                "12|39\n" +
                "37|34\n" +
                "37|96\n" +
                "37|26\n" +
                "37|33\n" +
                "37|55\n" +
                "37|42\n" +
                "37|39\n" +
                "37|74\n" +
                "37|21\n" +
                "37|11\n" +
                "37|38\n" +
                "37|64\n" +
                "37|18\n" +
                "37|71\n" +
                "37|43\n" +
                "37|32\n" +
                "37|77\n" +
                "37|31\n" +
                "37|88\n" +
                "37|59\n" +
                "37|47\n" +
                "37|51\n" +
                "37|45\n" +
                "37|44\n" +
                "54|51\n" +
                "54|61\n" +
                "54|58\n" +
                "54|92\n" +
                "54|84\n" +
                "54|21\n" +
                "54|96\n" +
                "54|38\n" +
                "54|74\n" +
                "54|59\n" +
                "54|57\n" +
                "54|37\n" +
                "54|27\n" +
                "54|82\n" +
                "54|91\n" +
                "54|63\n" +
                "54|12\n" +
                "54|15\n" +
                "54|76\n" +
                "54|44\n" +
                "54|65\n" +
                "54|16\n" +
                "54|48\n" +
                "54|56\n" +
                "42|52\n" +
                "42|64\n" +
                "42|46\n" +
                "42|88\n" +
                "42|56\n" +
                "42|72\n" +
                "42|26\n" +
                "42|34\n" +
                "42|31\n" +
                "42|99\n" +
                "42|15\n" +
                "42|77\n" +
                "42|81\n" +
                "42|84\n" +
                "42|71\n" +
                "42|93\n" +
                "42|79\n" +
                "42|82\n" +
                "42|48\n" +
                "42|54\n" +
                "42|76\n" +
                "42|47\n" +
                "42|55\n" +
                "42|45\n" +
                "81|82\n" +
                "81|79\n" +
                "81|92\n" +
                "81|57\n" +
                "81|76\n" +
                "81|99\n" +
                "81|63\n" +
                "81|52\n" +
                "81|46\n" +
                "81|37\n" +
                "81|93\n" +
                "81|56\n" +
                "81|72\n" +
                "81|84\n" +
                "81|54\n" +
                "81|48\n" +
                "81|61\n" +
                "81|65\n" +
                "81|12\n" +
                "81|15\n" +
                "81|91\n" +
                "81|58\n" +
                "81|16\n" +
                "81|27\n" +
                "56|27\n" +
                "56|91\n" +
                "56|15\n" +
                "56|74\n" +
                "56|21\n" +
                "56|57\n" +
                "56|84\n" +
                "56|16\n" +
                "56|38\n" +
                "56|59\n" +
                "56|96\n" +
                "56|76\n" +
                "56|82\n" +
                "56|12\n" +
                "56|61\n" +
                "56|37\n" +
                "56|48\n" +
                "56|44\n" +
                "56|63\n" +
                "56|65\n" +
                "56|92\n" +
                "56|51\n" +
                "56|11\n" +
                "56|58\n" +
                "52|93\n" +
                "52|16\n" +
                "52|27\n" +
                "52|91\n" +
                "52|61\n" +
                "52|58\n" +
                "52|84\n" +
                "52|15\n" +
                "52|72\n" +
                "52|99\n" +
                "52|57\n" +
                "52|56\n" +
                "52|82\n" +
                "52|46\n" +
                "52|48\n" +
                "52|96\n" +
                "52|65\n" +
                "52|76\n" +
                "52|12\n" +
                "52|79\n" +
                "52|92\n" +
                "52|37\n" +
                "52|63\n" +
                "52|54\n" +
                "11|18\n" +
                "11|33\n" +
                "11|77\n" +
                "11|99\n" +
                "11|46\n" +
                "11|45\n" +
                "11|32\n" +
                "11|52\n" +
                "11|64\n" +
                "11|72\n" +
                "11|47\n" +
                "11|88\n" +
                "11|93\n" +
                "11|34\n" +
                "11|79\n" +
                "11|26\n" +
                "11|55\n" +
                "11|42\n" +
                "11|31\n" +
                "11|39\n" +
                "11|54\n" +
                "11|81\n" +
                "11|71\n" +
                "11|43\n" +
                "64|56\n" +
                "64|52\n" +
                "64|31\n" +
                "64|27\n" +
                "64|63\n" +
                "64|65\n" +
                "64|46\n" +
                "64|76\n" +
                "64|48\n" +
                "64|88\n" +
                "64|45\n" +
                "64|82\n" +
                "64|79\n" +
                "64|93\n" +
                "64|47\n" +
                "64|15\n" +
                "64|71\n" +
                "64|81\n" +
                "64|84\n" +
                "64|72\n" +
                "64|16\n" +
                "64|92\n" +
                "64|54\n" +
                "64|99\n" +
                "43|31\n" +
                "43|93\n" +
                "43|56\n" +
                "43|81\n" +
                "43|88\n" +
                "43|71\n" +
                "43|26\n" +
                "43|42\n" +
                "43|72\n" +
                "43|46\n" +
                "43|76\n" +
                "43|48\n" +
                "43|54\n" +
                "43|45\n" +
                "43|77\n" +
                "43|18\n" +
                "43|33\n" +
                "43|52\n" +
                "43|47\n" +
                "43|79\n" +
                "43|34\n" +
                "43|64\n" +
                "43|99\n" +
                "43|55\n" +
                "65|96\n" +
                "65|37\n" +
                "65|59\n" +
                "65|44\n" +
                "65|18\n" +
                "65|34\n" +
                "65|32\n" +
                "65|51\n" +
                "65|55\n" +
                "65|11\n" +
                "65|27\n" +
                "65|33\n" +
                "65|21\n" +
                "65|57\n" +
                "65|91\n" +
                "65|58\n" +
                "65|74\n" +
                "65|12\n" +
                "65|43\n" +
                "65|42\n" +
                "65|38\n" +
                "65|39\n" +
                "65|61\n" +
                "65|16\n" +
                "59|72\n" +
                "59|64\n" +
                "59|52\n" +
                "59|34\n" +
                "59|88\n" +
                "59|11\n" +
                "59|45\n" +
                "59|31\n" +
                "59|77\n" +
                "59|71\n" +
                "59|42\n" +
                "59|18\n" +
                "59|46\n" +
                "59|44\n" +
                "59|99\n" +
                "59|81\n" +
                "59|43\n" +
                "59|39\n" +
                "59|47\n" +
                "59|79\n" +
                "59|26\n" +
                "59|33\n" +
                "59|32\n" +
                "48|12\n" +
                "48|16\n" +
                "48|59\n" +
                "48|92\n" +
                "48|44\n" +
                "48|65\n" +
                "48|91\n" +
                "48|15\n" +
                "48|84\n" +
                "48|38\n" +
                "48|39\n" +
                "48|82\n" +
                "48|51\n" +
                "48|96\n" +
                "48|32\n" +
                "48|58\n" +
                "48|21\n" +
                "48|57\n" +
                "48|27\n" +
                "48|11\n" +
                "48|37\n" +
                "48|61\n" +
                "26|72\n" +
                "26|93\n" +
                "26|82\n" +
                "26|76\n" +
                "26|15\n" +
                "26|88\n" +
                "26|71\n" +
                "26|45\n" +
                "26|92\n" +
                "26|84\n" +
                "26|64\n" +
                "26|79\n" +
                "26|31\n" +
                "26|65\n" +
                "26|48\n" +
                "26|46\n" +
                "26|63\n" +
                "26|52\n" +
                "26|81\n" +
                "26|47\n" +
                "26|56\n" +
                "63|59\n" +
                "63|37\n" +
                "63|12\n" +
                "63|27\n" +
                "63|92\n" +
                "63|91\n" +
                "63|51\n" +
                "63|32\n" +
                "63|57\n" +
                "63|16\n" +
                "63|18\n" +
                "63|33\n" +
                "63|21\n" +
                "63|44\n" +
                "63|61\n" +
                "63|38\n" +
                "63|39\n" +
                "63|96\n" +
                "63|74\n" +
                "63|58\n" +
                "91|74\n" +
                "91|55\n" +
                "91|39\n" +
                "91|34\n" +
                "91|38\n" +
                "91|11\n" +
                "91|32\n" +
                "91|51\n" +
                "91|18\n" +
                "91|45\n" +
                "91|59\n" +
                "91|47\n" +
                "91|88\n" +
                "91|37\n" +
                "91|26\n" +
                "91|43\n" +
                "91|96\n" +
                "91|44\n" +
                "91|21\n" +
                "46|96\n" +
                "46|56\n" +
                "46|37\n" +
                "46|91\n" +
                "46|84\n" +
                "46|93\n" +
                "46|92\n" +
                "46|99\n" +
                "46|57\n" +
                "46|16\n" +
                "46|76\n" +
                "46|79\n" +
                "46|15\n" +
                "46|65\n" +
                "46|54\n" +
                "46|27\n" +
                "46|61\n" +
                "46|58\n" +
                "21|74\n" +
                "21|55\n" +
                "21|51\n" +
                "21|45\n" +
                "21|42\n" +
                "21|26\n" +
                "21|38\n" +
                "21|81\n" +
                "21|71\n" +
                "21|31\n" +
                "21|47\n" +
                "21|77\n" +
                "21|18\n" +
                "21|44\n" +
                "21|39\n" +
                "21|43\n" +
                "21|88\n" +
                "99|58\n" +
                "99|93\n" +
                "99|84\n" +
                "99|96\n" +
                "99|54\n" +
                "99|91\n" +
                "99|48\n" +
                "99|16\n" +
                "99|61\n" +
                "99|65\n" +
                "99|38\n" +
                "99|72\n" +
                "99|15\n" +
                "99|63\n" +
                "99|76\n" +
                "99|57\n" +
                "38|43\n" +
                "38|46\n" +
                "38|26\n" +
                "38|71\n" +
                "38|59\n" +
                "38|31\n" +
                "38|44\n" +
                "38|18\n" +
                "38|39\n" +
                "38|74\n" +
                "38|33\n" +
                "38|55\n" +
                "38|42\n" +
                "38|45\n" +
                "38|81\n" +
                "33|84\n" +
                "33|71\n" +
                "33|88\n" +
                "33|64\n" +
                "33|81\n" +
                "33|45\n" +
                "33|72\n" +
                "33|46\n" +
                "33|55\n" +
                "33|18\n" +
                "33|76\n" +
                "33|79\n" +
                "33|48\n" +
                "33|26\n" +
                "32|72\n" +
                "32|26\n" +
                "32|93\n" +
                "32|54\n" +
                "32|34\n" +
                "32|81\n" +
                "32|79\n" +
                "32|55\n" +
                "32|64\n" +
                "32|31\n" +
                "32|43\n" +
                "32|76\n" +
                "32|99\n" +
                "96|21\n" +
                "96|33\n" +
                "96|88\n" +
                "96|18\n" +
                "96|81\n" +
                "96|47\n" +
                "96|34\n" +
                "96|77\n" +
                "96|51\n" +
                "96|64\n" +
                "96|26\n" +
                "96|38\n" +
                "77|48\n" +
                "77|99\n" +
                "77|46\n" +
                "77|52\n" +
                "77|65\n" +
                "77|79\n" +
                "77|82\n" +
                "77|63\n" +
                "77|16\n" +
                "77|45\n" +
                "77|47\n" +
                "27|42\n" +
                "27|11\n" +
                "27|51\n" +
                "27|38\n" +
                "27|58\n" +
                "27|74\n" +
                "27|43\n" +
                "27|33\n" +
                "27|61\n" +
                "27|34\n" +
                "76|63\n" +
                "76|27\n" +
                "76|16\n" +
                "76|84\n" +
                "76|48\n" +
                "76|21\n" +
                "76|59\n" +
                "76|58\n" +
                "76|39\n" +
                "79|21\n" +
                "79|82\n" +
                "79|84\n" +
                "79|15\n" +
                "79|56\n" +
                "79|93\n" +
                "79|54\n" +
                "79|72\n" +
                "93|59\n" +
                "93|27\n" +
                "93|63\n" +
                "93|96\n" +
                "93|84\n" +
                "93|82\n" +
                "93|21\n" +
                "84|74\n" +
                "84|21\n" +
                "84|96\n" +
                "84|43\n" +
                "84|16\n" +
                "84|32\n" +
                "45|15\n" +
                "45|82\n" +
                "45|31\n" +
                "45|52\n" +
                "45|46\n" +
                "16|74\n" +
                "16|42\n" +
                "16|32\n" +
                "16|91\n" +
                "57|38\n" +
                "57|26\n" +
                "57|59\n" +
                "15|51\n" +
                "15|74\n" +
                "55|63\n" +
                "\n" +
                "79,99,31,72,34,11,43,42,39,52,32,77,93\n" +
                "34,88,46,72,93,56,63\n" +
                "15,12,99,92,84,48,76,82,79,81,61,31,56,63,46,45,72\n" +
                "46,79,54,76,27,37,96\n" +
                "42,34,79,72,54,76,48\n" +
                "93,72,82,81,46,16,45,92,65,47,27,88,15,63,76,79,84,52,56\n" +
                "71,46,55,18,34,64,42,77,11,31,51,26,45,43,44,47,88,33,32\n" +
                "21,38,74,61,82,51,39,65,91,96,16,32,15,58,63,37,43\n" +
                "31,56,48,63,16,61,12\n" +
                "65,27,12,37,96,21,51,74,59,11,39,33,55\n" +
                "57,44,43,74,11,64,12\n" +
                "45,31,59,71,88,21,34,26,96,11,47\n" +
                "18,42,55,77,64,47,71,45,88,31,52,46,99,79,72,93,54,56,76,48,84\n" +
                "59,11,39,32,33,18,42,77,45,81,52,99,79\n" +
                "12,57,91,37,96,74,59,44,11,43,33,18,42,55,34,77,64\n" +
                "38,59,33,18,71,45,88\n" +
                "21,37,58,91,15,44,12\n" +
                "34,46,26,88,72,71,52,93,47\n" +
                "33,26,77,64,47,52,46,79,93,76,48\n" +
                "45,88,99,15,48,77,31,81,76,26,93,52,47,84,56,54,79,82,64,55,71,34,46\n" +
                "48,93,47,34,54,42,46,76,99,26,84,71,88,45,56,81,52,18,64,55,77,31,72\n" +
                "56,55,52,71,33,64,99,93,76,18,31,26,46,34,79,42,45,77,72\n" +
                "96,43,18,92,57,42,74,37,33,59,38,51,11,61,58,21,12,27,44,16,91\n" +
                "64,47,99,48,84\n" +
                "56,76,48,84,82,15,63,92,65,61,12,57,58,91,37,96,21,38,51,59,44\n" +
                "27,59,65,51,16,57,43,12,18,91,61,96,37,39,58,63,21\n" +
                "45,52,99,79,48,82,63,65,16,61,12\n" +
                "58,37,96,21,38,74,59,44,32,43,33,18,34,26,77,64,71\n" +
                "96,63,82,58,12,51,92,91,37,59,57,61,15,11,16,27,44,84,38,74,39,21,48\n" +
                "56,93,52,16,72,61,82,46,27,54,48,84,79\n" +
                "54,93,15,63,38,76,82,21,65,37,91,84,57,92,61,16,58,56,48\n" +
                "21,84,59,61,15,12,57,74,44,96,16,38,63,51,32,27,82,58,65\n" +
                "93,76,48,52,65,37,58,27,99,15,61,84,63,92,16,56,91,82,72\n" +
                "48,82,12,91,21,51,39\n" +
                "44,33,37,34,59,32,96,18,55,58,38,39,47,21,26\n" +
                "16,27,61,12,91,96,21,51,74,59,32,33,18,42,34\n" +
                "32,74,42,59,51,34,96,91,43,39,44,57,27\n" +
                "31,46,84,99,15,64,48,81,55,82,45\n" +
                "15,27,61,12,37,96,38,74,44\n" +
                "43,34,71,88,81,72,54,56,76\n" +
                "51,74,21,96,71,34,26,59,38,42,64,11,18,37,45,43,39\n" +
                "45,88,31,81,52,79,72,54,56,76,84,15,63,65,16,61,12\n" +
                "58,48,21,56,92,51,38,54,84,72,96,93,63,65,57,27,76,61,12,15,37,82,91\n" +
                "82,79,16,48,91,12,15,57,76,56,96,58,63,72,99,61,37,93,65,54,27,92,84\n" +
                "93,91,65,58,81,46,12\n" +
                "48,15,63,92,74,11,39\n" +
                "92,27,42,21,11,12,44,32,96,51,74,16,61,33,58,91,38,57,59,65,18\n" +
                "56,61,72,15,12,51,57,27,48,76,96\n" +
                "63,56,79,93,58,84,46,76,72,82,57,27,54,15,92\n" +
                "45,48,84,31,15,88,81,64,26,92,63,99,79,52,82,47,54,56,46\n" +
                "47,71,45,88,31,52,46,99,79,93,54,56,48,84,82,15,63,92,65,16,27\n" +
                "91,84,15,99,93,72,79,61,27,46,65,81,76,54,12,52,57\n" +
                "76,64,34,48,99\n" +
                "18,64,26,46,42,99,45,43,81,34,74,11,47\n" +
                "33,34,26,71,52,72,54,56,48\n" +
                "42,47,11,45,77,32,43,64,44,79,72,33,52\n" +
                "16,99,92,27,65,31,47,82,79,63,46\n" +
                "12,81,91,61,56,15,65,93,57\n" +
                "58,37,96,21,38,51,74,59,11,39,32,43,18,42,77,47,71\n" +
                "96,38,51,74,59,44,11,39,32,33,18,55,34,26,77,47,45,88,31\n" +
                "63,92,65,16,27,61,12,57,58,91,37,96,21,38,51,74,59,44,11,39,43,33,18\n" +
                "43,33,79,45,81,54,34,88,64,18,52,99,76,93,77\n" +
                "58,91,37,96,21,38,51,74,44,11,39,32,43,33,18,42,55,34,26,77,64,47,71\n" +
                "81,15,55,56,48,26,54\n" +
                "52,46,99,79,72,54,56,48,82,15,63,92,65,16,27,61,12,57,58,91,37\n" +
                "71,45,79,72,56\n" +
                "63,46,76,56,16,71,45,47,92,48,52,81,88,27,93,99,79,84,65,54,31\n" +
                "59,44,32,55,47,45,79\n" +
                "76,81,92,45,52,72,15,48,64,26,54\n" +
                "79,72,54,56,48,84,15,65,16,27,61,12,57,58,91,37,96,21,38\n" +
                "79,93,84,63,92,65,61,57,58,96,38\n" +
                "81,99,93,54,56,27,91\n" +
                "99,79,72,93,54,56,76,48,84,15,63,92,65,16,61,12,91,37,21\n" +
                "96,61,65,21,91,54,99\n" +
                "64,72,46,11,26,77,18,44,79,52,33\n" +
                "51,74,59,11,39,32,43,34,26,64,46\n" +
                "21,92,63,57,91,38,58,54,84,74,15,59,16,27,96,51,82,56,48\n" +
                "91,56,76,58,99,72,93,54,61,52,79,48,46\n" +
                "63,91,16,59,18,32,39\n" +
                "33,11,74,71,31,51,96\n" +
                "63,91,37,96,44,32,18\n" +
                "72,93,76,48,84,82,15,63,92,65,16,27,61,12,58,91,96\n" +
                "43,82,65,59,63,37,74,11,61,39,91,58,16\n" +
                "39,51,44,92,43,96,57,12,42,16,32,38,91,21,74\n" +
                "58,91,16,43,63,96,18,37,65\n" +
                "33,72,54,34,77,99,31,26,88,39,81\n" +
                "16,27,56,93,82,92,84,31,76,65,46,52,57,58,81\n" +
                "54,56,76,48,84,82,15,63,92,65,27,61,12,57,58,37,21,38,51,74,59\n" +
                "99,79,72,93,76,48,84,82,15,92,16,27,12,57,58,91,37,96,21\n" +
                "32,33,18,12,39,77,34,96,61,74,44,21,91,37,42,57,51,26,58,11,38,55,59\n" +
                "44,18,55,12,34,58,51,59,33\n" +
                "82,21,59,16,96,15,44,84,74,63,92,51,39,37,61,27,91,38,32\n" +
                "57,58,91,37,38,51,44,11,39,32,43,33,18,42,55,34,77,64,47\n" +
                "39,32,18,42,55,34,26,77,64,71,45,88,31,81,52,99,79,93,54\n" +
                "99,65,52,77,81,71,93\n" +
                "81,79,47,99,18,42,59,77,52,44,55,64,11,34,26\n" +
                "33,77,47,71,88,79,48\n" +
                "16,27,61,57,58,91,37,96,51,74,59,44,11,39,32,43,33,18,42,55,34\n" +
                "37,57,91,27,12,96,65,61,51,39,58,59,44,21,15,92,32,43,11,38,33,16,63\n" +
                "48,84,15,92,16,27,61,12,57,91,21,38,51,59,44,11,39\n" +
                "65,27,61,12,37,38,59\n" +
                "42,26,47,71,88,81,52,46,79,72,54,48,82\n" +
                "64,18,33,88,51,81,38,47,52,71,34,26,55,11,31\n" +
                "34,26,64,47,71,45,88,81,52,46,79,72,93,56,48,84,82,15,63\n" +
                "47,45,81,46,72,54,56,84,15,63,92,65,27\n" +
                "99,71,79,81,92,45,82,54,31,47,88,63,93\n" +
                "79,72,93,56,76,48,84,82,15,92,65,27,12,57,58,91,96,21,38\n" +
                "71,44,31,11,46,88,55,33,18,39,52,79,34,47,64,45,77\n" +
                "57,91,37,38,51,43,18,55,34\n" +
                "72,93,54,56,76,48,84,15,92,16,61,57,58,91,37,96,21,38,51\n" +
                "65,56,48,63,46,79,72,88,15,99,64,45,71,84,16\n" +
                "77,64,47,71,45,88,31,81,52,46,99,79,72,54,56,76,48,84,82,15,63,92,65\n" +
                "11,57,42,91,58,18,51,61,12,43,27,32,92\n" +
                "65,91,63,51,39,58,57,84,92,48,12\n" +
                "79,93,54,56,82,15,92,27,61,12,37,96,21\n" +
                "79,46,76,26,47,99,54,43,71,45,34\n" +
                "48,31,54,52,46,63,15,92,88,56,77,47,72,65,64,79,81,71,99\n" +
                "59,81,51,39,38,33,71,74,55,64,26,45,52\n" +
                "34,88,47,56,15,72,26,79,77,45,71,93,63,76,84\n" +
                "21,38,51,74,59,11,43,18,47,31,81\n" +
                "65,33,39,21,91,11,37,59,58,44,63,74,16,18,57,12,43,92,61,27,32,51,96\n" +
                "72,82,65,15,79,63,46,52,54,93,16,56,48,12,61,76,84,99,92\n" +
                "57,91,61,96,84,46,54,16,63,99,48,92,37,56,58\n" +
                "42,71,26,45,51,11,32,33,81,43,77,18,64,21,55,34,31,88,59,47,39,44,38\n" +
                "82,48,76,37,61,57,63,84,58,15,56,79,27,72,91,54,12,21,99\n" +
                "54,63,96,74,58,59,37,84,27,57,91\n" +
                "47,84,82,77,71,88,15,31,52,56,65,92,72,63,64,81,48,54,93,45,46,79,99\n" +
                "55,43,44,18,58\n" +
                "44,11,39,18,77,71,45,79,72\n" +
                "79,46,56,72,84,31,88,52,99,93,71,61,16,76,63,54,65,45,27\n" +
                "93,47,52,64,84\n" +
                "18,55,26,47,46,99,93\n" +
                "12,15,63,74,27,82,43,37,38,21,51,96,39,32,59,61,16\n" +
                "45,88,31,81,52,46,99,79,72,93,54,56,76,48,84,82,15,63,92,65,16,27,12\n" +
                "16,27,61,12,57,58,91,37,96,21,38,51,59,11,39,32,43,33,18,42,34\n" +
                "16,59,12,57,27,65,38,61,48,74,91,82,84,21,51\n" +
                "92,58,15,61,43,32,37,21,44,91,16,27,96,57,51,12,59,65,39,11,33\n" +
                "37,44,32,33,42,55,26,64,88\n" +
                "64,72,71,45,55,42,46,79,81,32,93,77,54,34,31,47,26,39,18,33,88\n" +
                "84,46,72,37,15,76,65,79,58,16,96,54,57,48,82,92,61\n" +
                "71,92,79,16,31,61,63,76,99,84,82,46,72,27,81,56,54,48,88\n" +
                "55,79,26,32,33,45,31,56,64,46,77\n" +
                "96,38,74,11,39,32,33,18,55,34,64\n" +
                "61,65,38,58,39,15,91,12,21\n" +
                "33,18,42,55,26,77,64,47,71,45,88,31,81,52,46,99,79,72,93,54,48\n" +
                "57,48,76,61,91,37,21,82,58,38,84,96,72,16,54,12,79,56,15,63,65\n" +
                "27,72,61,54,57,52,56,99,88,84,76,46,79,48,16\n" +
                "42,47,88,31,52,46,72,93,76\n" +
                "77,71,31,99,93,56,48,84,65\n" +
                "77,64,71,52,46,99,79,82,15,63,92\n" +
                "56,76,48,84,82,15,92,65,16,27,61,12,57,58,91,37,96,51,74,59,44\n" +
                "88,16,48,57,65,27,82\n" +
                "82,15,63,65,16,27,61,12,57,58,37,96,21,38,51,74,59,44,11,39,32\n" +
                "21,38,51,74,59,44,39,32,43,33,18,42,34,77,64,47,81\n" +
                "16,27,61,12,91,96,21,51,74,59,44,11,43,33,18,42,34\n" +
                "33,38,12,44,55,91,27,43,37,59,18,26,51,11,34,58,21,32,61,42,57\n" +
                "64,77,46,56,88\n" +
                "34,26,45,31,99,79,93,76,48\n" +
                "44,37,96,43,51,34,32,58,33,26,27\n" +
                "91,92,65,21,51,58,59,57,96,32,74,12,27\n" +
                "72,48,15,65,96\n" +
                "58,51,39,18,59,55,34,12,16,42,74\n" +
                "59,44,11,39,32,43,33,18,42,55,34,26,77,64,71,45,88,31,81,52,46,99,79\n" +
                "56,57,96,74,15,82,21,63,92,65,84,76,91,61,48,44,16,38,59\n" +
                "88,99,84,15,63,79,45,61,27,93,46,65,12\n" +
                "57,51,61,55,43,12,77\n" +
                "15,63,92,65,16,27,61,12,58,91,37,96,21,38,51,74,59,44,11,39,32,43,33\n" +
                "46,81,55,76,15,45,52\n" +
                "58,92,16,57,48,61,38,82,72,51,54,56,63,93,37,12,84,91,96,15,21,65,76\n" +
                "33,43,42,34,38,51,59,55,64,74,31,52,18,47,39,88,44,26,32,77,71\n" +
                "82,55,56,52,48,71,34,26,42,93,45,77,79\n" +
                "32,33,42,64,47,88,31,81,79,72,56\n" +
                "39,71,96,59,21,11,43,18,77,42,45,51,88,44,33,74,31,64,47\n" +
                "99,72,71,77,48,26,46,76,47,64,56,92,52,45,54,82,31,88,15\n" +
                "96,61,15,82,92,27,72,58,79,38,65,48,57,91,84,63,21\n" +
                "33,26,31,42,18,55,99,39,54,45,93,72,71,79,81,88,77,52,47,46,43\n" +
                "65,56,58,12,27,52,54,91,46,99,16,82,72,92,81\n" +
                "32,43,42,26,64,47,71,45,88,31,81,46,99,79,72,54,56\n" +
                "42,55,64,45,46,93,76,84,82\n" +
                "59,11,39,43,33,18,42,34,77,64,47,71,45,88,31,52,46,99,79\n" +
                "44,42,26,77,47,71,45,88,31,81,52,99,72\n" +
                "34,64,47,31,52,46,93,76,63\n" +
                "82,32,96,74,12,15,38,43,57,63,91\n" +
                "72,56,76,48,84,82,15,63,92,65,16,27,61,12,57,58,91,37,96,38,51\n" +
                "74,59,44,11,39,43,33,55,34,77,64,47,71,88,31,81,52,46,99\n" +
                "45,88,31,81,52,46,99,79,93,54,56,76,48,84,82,15,63,92,65,16,27,61,12\n" +
                "96,21,51,74,44,11,43,33,18,77,64,47,71,88,31\n" +
                "27,61,57,58,91,37,96,21,38,51,74,59,44,11,32,43,33,18,55,34,26\n" +
                "92,65,57,21,38,11,39,32,43,33,42\n" +
                "32,55,47,31,71,52,39,42,79,11,45,93,72,18,26,99,34,88,81,46,43,77,33\n" +
                "91,16,57,82,93,96,48,37,38,21,56,58,61,15,92,74,84\n" +
                "92,61,12,57,21,39,42\n" +
                "91,37,96,21,38,51,74,11,43,33,42,55,77,64,45\n" +
                "46,99,79,72,93,54,76,84,82,15,63,92,65,16,27,12,57,58,91,37,96";


        String input1 = "47|53\n" +
                "97|13\n" +
                "97|61\n" +
                "97|47\n" +
                "75|29\n" +
                "61|13\n" +
                "75|53\n" +
                "29|13\n" +
                "97|29\n" +
                "53|29\n" +
                "61|53\n" +
                "97|53\n" +
                "61|29\n" +
                "47|13\n" +
                "75|47\n" +
                "97|75\n" +
                "47|61\n" +
                "75|61\n" +
                "47|29\n" +
                "75|13\n" +
                "53|13\n" +
                "\n" +
                "75,47,61,53,29\n" +
                "97,61,53,29,13\n" +
                "75,29,13\n" +
                "75,97,47,61,53\n" +
                "61,13,29\n" +
                "97,13,75,29,47";
        String[] split = input.split("\n\n");

        String[] pages = split[0].split("\\n");
        String[] order = split[1].split("\\n");
        List<List<Integer>> orderList = new ArrayList<>();
        for (String s : order) {
            orderList.add(Arrays.stream(s.split(",")).map(Integer::valueOf).collect(Collectors.toList()));
        }

        int answer1 = solutionForPartOne(pages, orderList);
        System.out.println(answer1);

        int answer2 = solutionForPartTwo(pages, orderList);
        System.out.println(answer2);
    }

    static final int CORRECT = -1;

    public static int solutionForPartOne(String[] pages, List<List<Integer>> orderList) {
        int res = 0;
        Map<Integer, Set<Integer>> map = new HashMap<>();
        for (String page : pages) {
            String[] split = page.split("\\|");
            int a = Integer.parseInt(split[0]);
            int b = Integer.parseInt(split[1]);
            if (map.containsKey(a)) {
                map.get(a).add(b);
            } else {
                map.put(a, new HashSet<>(Collections.singletonList(b)));
            }
        }

        for (List<Integer> list : orderList) {

            if (Objects.equals(isCorrect(map, list), CORRECT)) {
                res += list.get(list.size() / 2);
            }
        }
        return res;
    }

    public static int isCorrect(Map<Integer, Set<Integer>> map, List<Integer> list) {
        int res = CORRECT;
        for (int i = 1; i < list.size(); i++) {
            Integer cur = list.get(i);
            Integer pre = list.get(i - 1);

            Set<Integer> set = map.get(cur);
            if (Objects.isNull(set)) {
                continue;
            }
            if (set.contains(pre)) {
                res = i;
                break;
            }
        }
        return res;
    }

    public static int solutionForPartTwo(String[] pages, List<List<Integer>> orderList) {
        int res = 0;
        Map<Integer, Set<Integer>> map = new HashMap<>();
        for (String page : pages) {
            String[] split = page.split("\\|");
            int a = Integer.parseInt(split[0]);
            int b = Integer.parseInt(split[1]);
            if (map.containsKey(a)) {
                map.get(a).add(b);
            } else {
                map.put(a, new HashSet<>(Collections.singletonList(b)));
            }
        }

        for (List<Integer> list : orderList) {
            int status = isCorrect(map, list);
            while (!Objects.equals(status, CORRECT)) {
                list = modify(map, list, status);
                status = isCorrect(map, list);
                if (Objects.equals(status, CORRECT)) {
                    res += list.get(list.size() / 2);
                }
            }
        }
        return res;
    }

    public static List<Integer> modify(Map<Integer, Set<Integer>> map, List<Integer> list, int index) {
        List<Integer> res = new ArrayList<>(list);

        Integer cur = list.get(index);
        Integer pre = list.get(index - 1);
        Set<Integer> set = map.get(cur);
        if (Objects.isNull(set)) {
            res.remove(cur);
            res.add(cur);
            return res;
        }
        if (set.contains(pre)) {
            res.set(index, pre);
            res.set(index - 1, cur);
        }
        return res;
    }
}
